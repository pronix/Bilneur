<%= render '/shared/order_status', :step => "billing" %>
 <h1 class="chkHd">Billing Details</h1>

<fieldset id="payment">
  <legend><%= t("payment_information") %></legend>
  <%= hook :checkout_payment_step, {:form => form} do %>
    <% @order.available_payment_methods.each do |method| %>
    <p>
      <label>
        <%= radio_button_tag "order[payments_attributes][][payment_method_id]", method.id, method == @order.payment_method %>
        <%= t(method.name, :scope => :payment_methods, :default => method.name) %>
      </label>
    </p>
    <% end %>

    <ul id="payment-methods">
      <% @order.available_payment_methods.each do |method| %>
        <li id="payment_method_<%= method.id %>"
            <%=   method == @order.payment_method ? " style='display:block;' " : " style='display:none;' "%>
            <%= ' class="last"' if method == @order.available_payment_methods.last %>>
          <fieldset>
            <%= render "checkout/payment/#{method.method_type}", :payment_method => method %>
          </fieldset>
        </li>
      <% end %>
    </ul>

    <br style='clear:both;' />
    <%= hook :coupon_code_field, {:form => form} %>
  <% end %>
</fieldset>

<hr class="space" />
<% unless @order.virtual? %>
<div id="new-address">
  <%= render :partial => 'addresses', :locals => { :address_name => "bill", :address => (@new_address||Address.default)  } %>
</div>
<% end %>

<div class="form-buttons">
  <input type="submit" class="continue button primary" value="<%=t("save_and_continue") %>" />
</div>
